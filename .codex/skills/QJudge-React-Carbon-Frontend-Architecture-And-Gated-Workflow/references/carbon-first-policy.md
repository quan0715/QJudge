# Carbon-first / Styling Policy

- 禁止新增或修改 `.cds--*` / `.bx--*` selector 覆蓋 Carbon 樣式（除非在 allowlist 且有理由）。
- 禁止 `!important`。
- Layout 必須使用 Carbon Grid/Row/Column/FlexGrid；僅在局部需要時輔以 Carbon `Stack`/`Layer`，避免自定義 display:flex 破壞 spacing。
- SCSS 間距請使用 `@carbon/layout` tokens，例如：
  - `@use '@carbon/layout';`
  - `margin-bottom: layout.$spacing-05;`
  - `width: layout.rem(24px);`
- Tile/Card 預設外觀：避免自訂圓角、陰影、背景色，保持 Carbon Tile/Layer 原樣；僅調整內部間距/分欄即可。
- Theme 使用（對應 Carbon themes overview）：
  - React 應用使用 `<Theme theme="white|g10|g90|g100">` 包覆應用（Top-level），並在 `document.documentElement` 設 `data-carbon-theme` 供 CSS token 生效。
  - 不要在全域 SCSS 直接設定背景/文字顏色；若需預設底色可用 `var(--cds-layer-01)`/`var(--cds-text-primary)`。
  - 動態切換：存儲使用者偏好（light/dark/system），轉換為 Carbon theme 名稱；系統主題變更需監聽 `prefers-color-scheme`。
  - 不覆蓋 CSS token：避免在 `globals.scss` 直接覆寫 `--cds-*` 變數；必要時另建 allowlist。
  - 全域背景/文字：`body`/`html` 建議設定 `background-color: var(--cds-background); color: var(--cds-text-primary);`，避免自訂常數導致 dark/light 不一致。
- Typography：
  - 使用 Carbon type set mixin：`@use '@carbon/type';`，並在選擇器內 `@include type.style('productive-heading-01');` 或其他 type set（參考 Carbon type-sets）。
  - 不手寫 font-size/line-height，優先用 type set mixin；必要時使用 tokens（例：`var(--cds-heading-03-font-size)`）而非常數。
  - 保持文字顏色使用 `var(--cds-text-primary|secondary)`，避免硬編碼顏色。
- `styles/carbon-overrides.scss` Allowlist 機制：
  - 只允許此單一檔案存在 Carbon override。
  - 每則 override 必須註明：日期、對應 Carbon issue/設計差異、影響範圍、移除條件。
  - PR 描述需說明新增 override 的必要性與回收計畫。
- 新增樣式優先使用 Carbon tokens/Layer/Theme，禁止自定義顏色/陰影取代 Carbon token。
